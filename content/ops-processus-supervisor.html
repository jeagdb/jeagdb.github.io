<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Supervisor</title><meta name="description" content="Picou website"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/logo512.png"/><meta name="next-head-count" content="5"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-096e6c2702c5645c.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-25c9a70a89fc94c8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-83b36c5ab3bef3ff.js" defer=""></script><script src="/_next/static/chunks/29107295-8619d3a1a46e5850.js" defer=""></script><script src="/_next/static/chunks/990-3d0511772ae2746e.js" defer=""></script><script src="/_next/static/chunks/pages/content/%5Bid%5D-182ced4f7935e1b2.js" defer=""></script><script src="/_next/static/z2n-YaQJOsDtzz0xd471Z/_buildManifest.js" defer=""></script><script src="/_next/static/z2n-YaQJOsDtzz0xd471Z/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.11">.byDFHs{margin-left:16px;font-size:18px;}/*!sc*/
data-styled.g3[id="Folder__Block-sc-1b0px8i-0"]{content:"byDFHs,"}/*!sc*/
.ktMjFI{cursor:pointer;font-size:18px;}/*!sc*/
data-styled.g4[id="Folder__FolderTitle-sc-1b0px8i-1"]{content:"ktMjFI,"}/*!sc*/
.gUxqNp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-self:start;-ms-flex-item-align:start;align-self:start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:auto;padding:16px;min-width:300px;max-height:500px;}/*!sc*/
data-styled.g5[id="Tree__Arborescence-sc-1jgaow7-0"]{content:"gUxqNp,"}/*!sc*/
.hVrUNP{background:linear-gradient(20deg,#FBEEC1,#659DBD,#DAAD86,#8D8741);background-size:150% 150%;-webkit-animation-name:flPffe;animation-name:flPffe;-webkit-animation-duration:40s;animation-duration:40s;-webkit-animation-timing-function:ease;animation-timing-function:ease;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;}/*!sc*/
data-styled.g6[id="GradientBg-sc-1qytzh1-0"]{content:"hVrUNP,"}/*!sc*/
*,*::before,*::after{box-sizing:border-box;}/*!sc*/
#__next{height:100%;}/*!sc*/
html{height:100%;margin:0;}/*!sc*/
body{margin:0;height:100%;color:white;font-family:'Roboto',sans-serif;background-image:black;}/*!sc*/
body *::-webkit-scrollbar{width:4px;}/*!sc*/
body *::-webkit-scrollbar-thumb{background:white;-webkit-transition:.5s;transition:.5s;}/*!sc*/
a{-webkit-text-decoration:none;text-decoration:none;color:inherit;}/*!sc*/
a:hover{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g7[id="sc-global-CLREq1"]{content:"sc-global-CLREq1,"}/*!sc*/
.egMgYg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/*!sc*/
data-styled.g8[id="MdVisualizer__Page-sc-1hka3jl-0"]{content:"egMgYg,"}/*!sc*/
.fUhEEA{position:absolute;top:0;right:0;border:1px solid #fff;border-top:none;border-right:none;padding:4px 4px 4px;color:#fff;background:#659DBD;}/*!sc*/
data-styled.g9[id="MdVisualizer__Title-sc-1hka3jl-1"]{content:"fUhEEA,"}/*!sc*/
.hpZncY{padding:0px 8px;width:100%;max-height:550px;overflow-y:scroll;}/*!sc*/
data-styled.g10[id="MdVisualizer__Content-sc-1hka3jl-2"]{content:"hpZncY,"}/*!sc*/
.dSCzhh{height:100%;width:100%;padding:24px 32px;}/*!sc*/
data-styled.g11[id="ContentLayout__Page-sc-1t6gg0-0"]{content:"dSCzhh,"}/*!sc*/
.bSrCqI{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:16px;}/*!sc*/
data-styled.g12[id="ContentLayout__Inline-sc-1t6gg0-1"]{content:"bSrCqI,"}/*!sc*/
.GMxsK{border:1px solid #fff;padding:0px 8px;height:80%;}/*!sc*/
data-styled.g13[id="ContentLayout__Markdown-sc-1t6gg0-2"]{content:"GMxsK,"}/*!sc*/
@-webkit-keyframes flPffe{0%{background-position:0% 100%;}50%{background-position:100% 0%;}100%{background-position:0% 100%;}}/*!sc*/
@keyframes flPffe{0%{background-position:0% 100%;}50%{background-position:100% 0%;}100%{background-position:0% 100%;}}/*!sc*/
data-styled.g14[id="sc-keyframes-flPffe"]{content:"flPffe,"}/*!sc*/
</style></head><body><div id="__next"><div class="GradientBg-sc-1qytzh1-0 ContentLayout__Page-sc-1t6gg0-0 hVrUNP dSCzhh"><div class="ContentLayout__Inline-sc-1t6gg0-1 bSrCqI"><div class="Tree__Arborescence-sc-1jgaow7-0 gUxqNp"><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 ktMjFI">backend<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 ktMjFI">frontend<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 ktMjFI">hardware<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 ktMjFI">ops<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 ktMjFI">projets<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 ktMjFI">reseaux<!-- --> <!-- -->+</div></div></div><div class="MdVisualizer__Page-sc-1hka3jl-0 egMgYg ContentLayout__Markdown-sc-1t6gg0-2 GMxsK"><div class="MdVisualizer__Title-sc-1hka3jl-1 fUhEEA"></div><div class="MdVisualizer__Content-sc-1hka3jl-2 hpZncY"><div><h1>Supervisor</h1>
<p>(Notion de socket/pid)</p>
<p>Supervisor est un petit outil codé en Python et permettant d'assurer le suivi et le contrôle de services/processus applicatifs sur des systèmes de type UNIX.
On peut le comparer à launchd (utilisé par OSX) ou runit. (mettre des liens)
Attention toutefois il n'est pas destiné à remplacer le process init des systèmes UNIX. (process init c'est quoi ?)
Il est par contre le parfait allié pour lancer et suivre des services applicatifs liés à un projet et qui doivent être démarrés et disponibles en permanence.</p>
<p>Supervisor est disponible en paquet Debian en version 3.0, l'installation est donc très facile :
<code>apt-get install supervisor</code></p>
<p>Supervisor est divisé en deux composants différents:</p>
<h3>Supervisord</h3>
<p>Supervisord est la partie qui a la responsabilité de démarrer les services configurés et de les redémarrer en cas de crash. Il est configurable via le fichier /etc/supervisor/supervisord.conf</p>
<h3>Supervisorctl</h3>
<p>Supervisorctl est le client permettant d'administrer les services gérés par supervisor. Il est capable de se connecter à plusieurs démons supervisord et permet de démarrer / arrêter des services. Il est possible de les faire fonctionner soit via une socket soit via TCP. Il est également possible de gérer une authentification lors de la connexion au démon.</p>
<h3>Exemples</h3>
<h4>Ajouter un service à supervisor</h4>
<p>Pour ajouter un service à supervisor il suffit de le déclarer en ajoutant un fichier dans /etc/supervisor/conf.d</p>
<pre><code>[program:blogd]
command=node node_modules/bin/blogd

directory=/srv/my_project

autostart=true
autorestart=true
startretries=20
numprocs=1
stdout_logfile=/var/log/blogd.log
redirect_stderr=true
</code></pre>
<p>Il faut ensuite redémarrer le supervisor pour appliquer les changements.</p>
<p>On peut également redémarrer un service, ou bien parcourir les logs.
Il y a également une interface web disponible activable via la section [inet_http_server]</p>
<h2>Capistrano</h2>
<p>Capistrano est un outil qui permet d'automatiser des tâches serveur, mais surtout de déployer simplement des applications. Même si il est développé en Ruby il est tout à fait possible de l'utiliser pour déployer des applications qui n'utilisent pas ce langage.</p>
<h2>PM2</h2>
</div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":{"id":"ops-processus-supervisor","path":"ops/processus/supervisor.md","content":"\u003ch1\u003eSupervisor\u003c/h1\u003e\n\u003cp\u003e(Notion de socket/pid)\u003c/p\u003e\n\u003cp\u003eSupervisor est un petit outil codé en Python et permettant d'assurer le suivi et le contrôle de services/processus applicatifs sur des systèmes de type UNIX.\nOn peut le comparer à launchd (utilisé par OSX) ou runit. (mettre des liens)\nAttention toutefois il n'est pas destiné à remplacer le process init des systèmes UNIX. (process init c'est quoi ?)\nIl est par contre le parfait allié pour lancer et suivre des services applicatifs liés à un projet et qui doivent être démarrés et disponibles en permanence.\u003c/p\u003e\n\u003cp\u003eSupervisor est disponible en paquet Debian en version 3.0, l'installation est donc très facile :\n\u003ccode\u003eapt-get install supervisor\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eSupervisor est divisé en deux composants différents:\u003c/p\u003e\n\u003ch3\u003eSupervisord\u003c/h3\u003e\n\u003cp\u003eSupervisord est la partie qui a la responsabilité de démarrer les services configurés et de les redémarrer en cas de crash. Il est configurable via le fichier /etc/supervisor/supervisord.conf\u003c/p\u003e\n\u003ch3\u003eSupervisorctl\u003c/h3\u003e\n\u003cp\u003eSupervisorctl est le client permettant d'administrer les services gérés par supervisor. Il est capable de se connecter à plusieurs démons supervisord et permet de démarrer / arrêter des services. Il est possible de les faire fonctionner soit via une socket soit via TCP. Il est également possible de gérer une authentification lors de la connexion au démon.\u003c/p\u003e\n\u003ch3\u003eExemples\u003c/h3\u003e\n\u003ch4\u003eAjouter un service à supervisor\u003c/h4\u003e\n\u003cp\u003ePour ajouter un service à supervisor il suffit de le déclarer en ajoutant un fichier dans /etc/supervisor/conf.d\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e[program:blogd]\ncommand=node node_modules/bin/blogd\n\ndirectory=/srv/my_project\n\nautostart=true\nautorestart=true\nstartretries=20\nnumprocs=1\nstdout_logfile=/var/log/blogd.log\nredirect_stderr=true\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIl faut ensuite redémarrer le supervisor pour appliquer les changements.\u003c/p\u003e\n\u003cp\u003eOn peut également redémarrer un service, ou bien parcourir les logs.\nIl y a également une interface web disponible activable via la section [inet_http_server]\u003c/p\u003e\n\u003ch2\u003eCapistrano\u003c/h2\u003e\n\u003cp\u003eCapistrano est un outil qui permet d'automatiser des tâches serveur, mais surtout de déployer simplement des applications. Même si il est développé en Ruby il est tout à fait possible de l'utiliser pour déployer des applications qui n'utilisent pas ce langage.\u003c/p\u003e\n\u003ch2\u003ePM2\u003c/h2\u003e\n","title":"Supervisor"}},"__N_SSG":true},"page":"/content/[id]","query":{"id":"ops-processus-supervisor"},"buildId":"z2n-YaQJOsDtzz0xd471Z","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>