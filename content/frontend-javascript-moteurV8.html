<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><title data-next-head="">Moteur V8</title><meta name="description" content="Jeagdb website" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1" data-next-head=""/><link rel="icon" href="/logo512.png" data-next-head=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-eaac0756275ee737.js" defer=""></script><script src="/_next/static/chunks/framework-b113f7c09350d15e.js" defer=""></script><script src="/_next/static/chunks/main-7b9ea7c8eb595266.js" defer=""></script><script src="/_next/static/chunks/pages/_app-693cebd7d95187e1.js" defer=""></script><script src="/_next/static/chunks/7e42aecb-fa76119ba4551ee6.js" defer=""></script><script src="/_next/static/chunks/98bef5de-8b6e3967867b2c11.js" defer=""></script><script src="/_next/static/chunks/639-af7f392fccbd8ef9.js" defer=""></script><script src="/_next/static/chunks/772-8f5a04283d92564f.js" defer=""></script><script src="/_next/static/chunks/pages/content/%5Bid%5D-b6289f3129555e3c.js" defer=""></script><script src="/_next/static/0XeLm8KfYpZBGTrmj6peW/_buildManifest.js" defer=""></script><script src="/_next/static/0XeLm8KfYpZBGTrmj6peW/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.11">*,*::before,*::after{box-sizing:border-box;}/*!sc*/
#__next{height:100%;width:100%;}/*!sc*/
html{height:100%;margin:0;}/*!sc*/
body{margin:0;height:100%;color:white;font-family:'Roboto',sans-serif;background-image:black;}/*!sc*/
body *::-webkit-scrollbar{width:4px;}/*!sc*/
body *::-webkit-scrollbar-thumb{background:white;-webkit-transition:.5s;transition:.5s;}/*!sc*/
a{-webkit-text-decoration:none;text-decoration:none;color:inherit;}/*!sc*/
a:hover{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
img{max-width:100%;}/*!sc*/
pre{background:grey;padding:2px 4px;border-radius:10px;}/*!sc*/
code{background:grey;padding:0px 4px;border-radius:10px;white-space:pre-wrap;}/*!sc*/
data-styled.g1[id="sc-global-bTRaNr1"]{content:"sc-global-bTRaNr1,"}/*!sc*/
.jAHpBr{position:absolute;top:0;width:24px;height:24px;top:8px;left:12px;padding:4px;cursor:pointer;}/*!sc*/
data-styled.g2[id="HomeButton-sc-1snf18r-0"]{content:"jAHpBr,"}/*!sc*/
.byDFHs{margin-left:16px;font-size:18px;}/*!sc*/
data-styled.g33[id="Folder__Block-sc-1b0px8i-0"]{content:"byDFHs,"}/*!sc*/
.hAjrvM{cursor:pointer;font-size:18px;}/*!sc*/
@media (max-width:769px){.hAjrvM{font-size:22px;}}/*!sc*/
data-styled.g34[id="Folder__FolderTitle-sc-1b0px8i-1"]{content:"hAjrvM,"}/*!sc*/
@media (max-width:769px){.dJFKXp{display:none;}}/*!sc*/
data-styled.g35[id="Tree__Container-sc-1jgaow7-0"]{content:"dJFKXp,"}/*!sc*/
.dxtDKA{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-self:start;-ms-flex-item-align:start;align-self:start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:auto;padding:16px;min-width:300px;max-height:500px;}/*!sc*/
data-styled.g36[id="Tree__Arborescence-sc-1jgaow7-1"]{content:"dxtDKA,"}/*!sc*/
.hVrUNP{background:linear-gradient(20deg,#FBEEC1,#659DBD,#DAAD86,#8D8741);background-size:150% 150%;-webkit-animation-name:flPffe;animation-name:flPffe;-webkit-animation-duration:40s;animation-duration:40s;-webkit-animation-timing-function:ease;animation-timing-function:ease;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;}/*!sc*/
data-styled.g37[id="GradientBg-sc-1qytzh1-0"]{content:"hVrUNP,"}/*!sc*/
.fkWwhY{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border:1px solid #fff;padding:0px 8px;max-width:100%;height:80%;}/*!sc*/
@media (max-width:769px){.fkWwhY{border:none;padding:0px 0px;margin-top:18px;font-size:16px;display:block;}}/*!sc*/
data-styled.g38[id="MdVisualizer__Page-sc-1hka3jl-0"]{content:"fkWwhY,"}/*!sc*/
.kixegV{position:absolute;top:0;right:0;border:1px solid #fff;border-top:none;border-right:none;padding:2px 16px;color:#fff;background:#659DBD;}/*!sc*/
@media (min-width:769px){.kixegV{font-size:17px;}}/*!sc*/
data-styled.g39[id="MdVisualizer__Title-sc-1hka3jl-1"]{content:"kixegV,"}/*!sc*/
.jToKSj{padding:0px 8px;max-height:550px;overflow-y:scroll;}/*!sc*/
data-styled.g40[id="MdVisualizer__Content-sc-1hka3jl-2"]{content:"jToKSj,"}/*!sc*/
.kicYxY{position:absolute;top:8px;left:12px;padding:4px;cursor:pointer;color:white;width:26px;}/*!sc*/
@media (min-width:769px){.kicYxY{display:none;}}/*!sc*/
data-styled.g41[id="MdVisualizer__BackButton-sc-1hka3jl-3"]{content:"kicYxY,"}/*!sc*/
.gdxHoY{height:100%;max-width:100%;padding:24px 32px;}/*!sc*/
data-styled.g42[id="ContentLayout__Page-sc-1t6gg0-0"]{content:"gdxHoY,"}/*!sc*/
.gRnpIg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:16px;max-width:100%;}/*!sc*/
@media (max-width:769px){.gRnpIg{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}/*!sc*/
data-styled.g43[id="ContentLayout__Inline-sc-1t6gg0-1"]{content:"gRnpIg,"}/*!sc*/
@-webkit-keyframes flPffe{0%{background-position:0% 100%;}50%{background-position:100% 0%;}100%{background-position:0% 100%;}}/*!sc*/
@keyframes flPffe{0%{background-position:0% 100%;}50%{background-position:100% 0%;}100%{background-position:0% 100%;}}/*!sc*/
data-styled.g172[id="sc-keyframes-flPffe"]{content:"flPffe,"}/*!sc*/
</style></head><body><div id="__next"><div class="GradientBg-sc-1qytzh1-0 ContentLayout__Page-sc-1t6gg0-0 hVrUNP gdxHoY"><div class="ContentLayout__Inline-sc-1t6gg0-1 gRnpIg"><div class="Tree__Container-sc-1jgaow7-0 dJFKXp"><a href="/"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="house" class="svg-inline--fa fa-house HomeButton-sc-1snf18r-0 jAHpBr" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" color="white"><path fill="currentColor" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg></a><div class="Tree__Arborescence-sc-1jgaow7-1 dxtDKA"><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 hAjrvM">basics<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 hAjrvM">frontend<!-- --> <!-- -->+</div></div><div class="Folder__Block-sc-1b0px8i-0 byDFHs"><div class="Folder__FolderTitle-sc-1b0px8i-1 hAjrvM">projets<!-- --> <!-- -->+</div></div></div></div><div class="MdVisualizer__Page-sc-1hka3jl-0 fkWwhY"><div class="MdVisualizer__Title-sc-1hka3jl-1 kixegV">Moteur V8</div><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-left" class="svg-inline--fa fa-arrow-left MdVisualizer__BackButton-sc-1hka3jl-3 kicYxY" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" color="white" font-size="10"><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path></svg><div class="MdVisualizer__Content-sc-1hka3jl-2 jToKSj"><div><h1>Moteur v8</h1>
<p>Moteur de Google, utilisé dans Google Chrome et NodeJS.</p>
<p>Le moteur est composé de 2 composants principaux :</p>
<ul>
<li><strong>Memory Heap</strong> : sert à allouer la mémoire utilisée dans le programme.</li>
<li><strong>Call Stack (pile d’exécution)</strong> : contient les données des fonctions exécutées par le programme.</li>
</ul>
<p>Des <strong>APIs</strong> situées en dehors du moteur sont également à la disposition du développeur.</p>
<p>La plupart sont souvent utilisées, tel que DOM ou setTimeout, et c’est également ici que nous avons les fameuses <strong>callback queue</strong> ainsi que <strong>event loop</strong>.</p>
<p>JavaScript étant <strong>single-threaded</strong>, cela veut dire qu’il n’y a qu’une seule pile d’exécution, nous ne pouvons donc faire <strong>qu’une chose à la fois</strong>.</p>
<p>La pile d’exécution est une structure de données qui enregistre où nous en sommes dans le programme.Si nous entrons dans une fonction, nous la mettons en haut de la pile.Si nous revenons d’une fonction, nous l’enlevons du haut de la pile.</p>
<p><img src="/images/v8-callstack.png" alt="v8-callstack.png"></p>
<p>Avoir qu’une seule pile d’exécution peut être pratique, car cela enlève tous les problèmes engendrés par le multithreading.</p>
<p>Cependant, exécuter un programme sur 1 seul thread a aussi un très gros inconvénient : tout est bloqué quand une tache est longue !</p>
<p>Alors que se passe-t-il quand une fonction dans la pile d’exécution prend énormément de temps à finir, par exemple, pour un traitement d’images dans votre navigateur ? Tout se bloque, de l’UI de votre page internet jusqu’au navigateur en lui-même.</p>
<p>En effet, votre navigateur va essayer de rafraîchir la page toute les <strong>1/60 secondes</strong>, et ne peut le faire que si la pile est vide.Si une de vos fonctions prend du temps, c’est la réactivité de votre site web qui en prendra un coup.</p>
<p>La solution qui nous est proposée (et que vous utilisez sans doute sans modération) est l’asynchrone, avec la <strong>callback queue</strong> et <strong>event loop</strong>.</p>
<hr>
<h2><strong>La compilation JavaScript dans les grandes lignes</strong></h2>
<ol>
<li><strong>Tokenizing</strong> : décomposer les chaines de caractères en des morceaux, appelés tokens, qui ont un sens pour le compilateur. Prenons le programme suivant : <code>var a = 1</code>; Lors de cette étape, les tokens suivants seront générés : <code>var</code>, <code>a</code>, <code>=</code>, <code>1</code>, <code>;</code>.</li>
<li><strong>Parsing</strong>: transformer le tableau de tokens généré précédemment en un arbre d’éléments imbriqués, il représente la structure du programme. (AST)</li>
<li><strong>Code-Generation</strong> : prend l’AST et le transforme en code exécutable.</li>
</ol>
<p>Les 3 acteurs:</p>
<ol>
<li><strong>Moteur</strong> : il s’occupe de tout, de la compilation à l’exécution de notre programme JS.</li>
<li><strong>Compilateur</strong> : il s’occupe de la compilation du programme.</li>
<li><strong>Scope</strong> : collecte et garde une liste des variables déclarées.</li>
</ol>
<p>Exemple <code>var a = 1;</code></p>
<p>Le moteur voit 1 action effectuée au moment de la compilation, et 1 autre, au moment de l’exécution. (En dehors de la tokenisation)</p>
<p>Décomposons :</p>
<ul>
<li>A l’encontre de <code>var a</code>, le Compilateur demande au Scope de regarder si la variable <code>a</code> existe déjà dans le scope en question.Si oui, le Compilateur ne fait rien et continue.Si non, le Compilateur demande à Scope de déclarer la variable <code>a</code> dans le scope en question.</li>
<li>Le Compilateur génère le code pour <code>a = 1</code> qui sera exécuté par le Moteur plus tard : Le Moteur demandera au Scope si <code>a</code> existe.Si oui, il utilisera cette variable.Si non, une erreur sera renvoyée.Pour résumer, 2 actions peuvent être distinguées lors de l’assignation d’une variable : lors de la compilation, le Compilateur déclare la variable (si elle n’existe pas déjà), et dans un deuxième temps, lors de l’exécution, le Moteur demande la variable à Scope, et lui assigne la valeur.</li>
</ul>
<p>On a 2 types de recherche: <strong>LHS</strong> et <strong>RHS</strong> (Left/Right Hand Side).</p>
<p>RHS: <code>console.log(a);</code> (ici on veut connaitre la valeur a)</p>
<p>LHS: <code>var a = 1;</code> (ici on n’est pas intéressé par la valeur de <code>a</code>. On veut simplement son conteneur pour lui assigner la valeur 2.)</p>
<p>Exemple:</p>
<pre><code>function foo(a) {
    var b = a;
    return a + b;
}
var c = foo(2);

</code></pre>
<p>Il y a ici 3 <strong>LHS</strong> et 4 <strong>RHS</strong>.</p>
<p><strong>LHS</strong> :</p>
<ul>
<li>c = .. (Récupération du conteneur c)</li>
<li>a = 2 (Assignement implicite au paramètre de la fonction foo)</li>
<li>b = .. (Récupération du conteneur b)</li>
</ul>
<p><strong>RHS</strong> :</p>
<ul>
<li>foo(2) (Récupération de la valeur de c)</li>
<li>.. = a (Récupération de la valeur de a)</li>
<li>a + .. (Récupération de la valeur de a)</li>
<li>.. + b (Récupération de la valeur de b)</li>
</ul>
<p>Scope: on disait jusqu’à maintenant que le Scope gardait une liste des variables déclarées. Seulement, il peut y avoir plusieurs Scopes.</p>
<p>De la même manière que les fonctions, les Scopes sont imbriqués les uns dans les autres.</p>
<p>Si une variable ne peut pas être trouvée dans le scope immédiat, le Moteur consulte le scope du « dessus ».</p>
<p>Tant qu’il ne trouve pas la variable, il continue à remonter jusque tout en haut (scope dit « global »).</p>
<hr>
<h2>Callback queue + Event loop</h2>
<p>Le Javascript étant un langage single-thread ****dans un univers du Web où la réactivité est importante, les APIs WEB ****ont pensé à une solution afin d’ajouter une composante asynchrone au langage : callback queue et event loop.</p>
<p>le moteur de Javascript ne peut pas effectuer plusieurs actions en même temps, mais les APIs WEB ****le peuvent. On peut donc les imaginer comme des threads à part entière.</p>
<p>Seulement, les ****APIs WEB ne peuvent pas modifier l’ordre d’exécution du code en ajoutant des éléments dans la stack. C’est pour cela que callback queue et event loop ****ont été créées.</p>
<p>Il s’agit d’une sorte de « file d’attente », qui permet d’effectuer des traitements sans bloquer la pile d’exécution JS.</p>
<p>Le rôle de event loop est tout simple : déplacer les éléments de la callback queue dans la pile d’exécution JS ****lorsque cette dernière est vide.</p>
<p><img src="/images/v8-eventloop.gif" alt="v8-eventloop.gif"></p>
<p>Attention: au même titre que la pile d’exécution JS, il n’existe qu’une seule callback queue. </p>
<p>Énormément d’appels peuvent délayer tous vos autres traitements asynchrones, ce qui peut donner un effet de ralentissement.</p>
<p>Exemple:</p>
<pre><code>console.log(’hi’);

setTimeout(function cb(){
    console.log(’there’)
}, 0);

console.log(’JSConfEU’);
</code></pre>
<p>On aura ici: hi - JSConfEU - there</p>
<p>même si le <code>setTimeout</code> se termine immédiatement, <strong>event loop</strong> doit attendre que la stack soit vide avant de pouvoir y mettre les éléments de <strong>callback queue</strong>. <code>there</code>sera donc affiché en dernier, même s’il termine avant le <code>console.log(’JSConfEU’)</code>.</p>
<p>Outil sympa: <a href="http://latentflip.com/loupe/">http://latentflip.com/loupe/</a></p>
<p>Sources</p>
<p><a href="https://fr.wikipedia.org/wiki/Moteur_V8">https://fr.wikipedia.org/wiki/Moteur_V8</a></p>
<p><a href="https://www.axopen.com/blog/2020/08/javascript-langage-compile/">https://www.axopen.com/blog/2020/08/javascript-callback-queue-event-loop/</a></p>
</div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":{"id":"frontend-javascript-moteurV8","path":"frontend/javascript/moteurV8.md","content":"\u003ch1\u003eMoteur v8\u003c/h1\u003e\n\u003cp\u003eMoteur de Google, utilisé dans Google Chrome et NodeJS.\u003c/p\u003e\n\u003cp\u003eLe moteur est composé de 2 composants principaux :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eMemory Heap\u003c/strong\u003e : sert à allouer la mémoire utilisée dans le programme.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCall Stack (pile d’exécution)\u003c/strong\u003e : contient les données des fonctions exécutées par le programme.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eDes \u003cstrong\u003eAPIs\u003c/strong\u003e situées en dehors du moteur sont également à la disposition du développeur.\u003c/p\u003e\n\u003cp\u003eLa plupart sont souvent utilisées, tel que DOM ou setTimeout, et c’est également ici que nous avons les fameuses \u003cstrong\u003ecallback queue\u003c/strong\u003e ainsi que \u003cstrong\u003eevent loop\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eJavaScript étant \u003cstrong\u003esingle-threaded\u003c/strong\u003e, cela veut dire qu’il n’y a qu’une seule pile d’exécution, nous ne pouvons donc faire \u003cstrong\u003equ’une chose à la fois\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eLa pile d’exécution est une structure de données qui enregistre où nous en sommes dans le programme.Si nous entrons dans une fonction, nous la mettons en haut de la pile.Si nous revenons d’une fonction, nous l’enlevons du haut de la pile.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/v8-callstack.png\" alt=\"v8-callstack.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAvoir qu’une seule pile d’exécution peut être pratique, car cela enlève tous les problèmes engendrés par le multithreading.\u003c/p\u003e\n\u003cp\u003eCependant, exécuter un programme sur 1 seul thread a aussi un très gros inconvénient : tout est bloqué quand une tache est longue !\u003c/p\u003e\n\u003cp\u003eAlors que se passe-t-il quand une fonction dans la pile d’exécution prend énormément de temps à finir, par exemple, pour un traitement d’images dans votre navigateur ? Tout se bloque, de l’UI de votre page internet jusqu’au navigateur en lui-même.\u003c/p\u003e\n\u003cp\u003eEn effet, votre navigateur va essayer de rafraîchir la page toute les \u003cstrong\u003e1/60 secondes\u003c/strong\u003e, et ne peut le faire que si la pile est vide.Si une de vos fonctions prend du temps, c’est la réactivité de votre site web qui en prendra un coup.\u003c/p\u003e\n\u003cp\u003eLa solution qui nous est proposée (et que vous utilisez sans doute sans modération) est l’asynchrone, avec la \u003cstrong\u003ecallback queue\u003c/strong\u003e et \u003cstrong\u003eevent loop\u003c/strong\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003e\u003cstrong\u003eLa compilation JavaScript dans les grandes lignes\u003c/strong\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eTokenizing\u003c/strong\u003e : décomposer les chaines de caractères en des morceaux, appelés tokens, qui ont un sens pour le compilateur. Prenons le programme suivant : \u003ccode\u003evar a = 1\u003c/code\u003e; Lors de cette étape, les tokens suivants seront générés : \u003ccode\u003evar\u003c/code\u003e, \u003ccode\u003ea\u003c/code\u003e, \u003ccode\u003e=\u003c/code\u003e, \u003ccode\u003e1\u003c/code\u003e, \u003ccode\u003e;\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eParsing\u003c/strong\u003e: transformer le tableau de tokens généré précédemment en un arbre d’éléments imbriqués, il représente la structure du programme. (AST)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCode-Generation\u003c/strong\u003e : prend l’AST et le transforme en code exécutable.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eLes 3 acteurs:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eMoteur\u003c/strong\u003e : il s’occupe de tout, de la compilation à l’exécution de notre programme JS.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCompilateur\u003c/strong\u003e : il s’occupe de la compilation du programme.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eScope\u003c/strong\u003e : collecte et garde une liste des variables déclarées.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eExemple \u003ccode\u003evar a = 1;\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eLe moteur voit 1 action effectuée au moment de la compilation, et 1 autre, au moment de l’exécution. (En dehors de la tokenisation)\u003c/p\u003e\n\u003cp\u003eDécomposons :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA l’encontre de \u003ccode\u003evar a\u003c/code\u003e, le Compilateur demande au Scope de regarder si la variable \u003ccode\u003ea\u003c/code\u003e existe déjà dans le scope en question.Si oui, le Compilateur ne fait rien et continue.Si non, le Compilateur demande à Scope de déclarer la variable \u003ccode\u003ea\u003c/code\u003e dans le scope en question.\u003c/li\u003e\n\u003cli\u003eLe Compilateur génère le code pour \u003ccode\u003ea = 1\u003c/code\u003e qui sera exécuté par le Moteur plus tard : Le Moteur demandera au Scope si \u003ccode\u003ea\u003c/code\u003e existe.Si oui, il utilisera cette variable.Si non, une erreur sera renvoyée.Pour résumer, 2 actions peuvent être distinguées lors de l’assignation d’une variable : lors de la compilation, le Compilateur déclare la variable (si elle n’existe pas déjà), et dans un deuxième temps, lors de l’exécution, le Moteur demande la variable à Scope, et lui assigne la valeur.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOn a 2 types de recherche: \u003cstrong\u003eLHS\u003c/strong\u003e et \u003cstrong\u003eRHS\u003c/strong\u003e (Left/Right Hand Side).\u003c/p\u003e\n\u003cp\u003eRHS: \u003ccode\u003econsole.log(a);\u003c/code\u003e (ici on veut connaitre la valeur a)\u003c/p\u003e\n\u003cp\u003eLHS: \u003ccode\u003evar a = 1;\u003c/code\u003e (ici on n’est pas intéressé par la valeur de \u003ccode\u003ea\u003c/code\u003e. On veut simplement son conteneur pour lui assigner la valeur 2.)\u003c/p\u003e\n\u003cp\u003eExemple:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003efunction foo(a) {\n    var b = a;\n    return a + b;\n}\nvar c = foo(2);\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIl y a ici 3 \u003cstrong\u003eLHS\u003c/strong\u003e et 4 \u003cstrong\u003eRHS\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eLHS\u003c/strong\u003e :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ec = .. (Récupération du conteneur c)\u003c/li\u003e\n\u003cli\u003ea = 2 (Assignement implicite au paramètre de la fonction foo)\u003c/li\u003e\n\u003cli\u003eb = .. (Récupération du conteneur b)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eRHS\u003c/strong\u003e :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efoo(2) (Récupération de la valeur de c)\u003c/li\u003e\n\u003cli\u003e.. = a (Récupération de la valeur de a)\u003c/li\u003e\n\u003cli\u003ea + .. (Récupération de la valeur de a)\u003c/li\u003e\n\u003cli\u003e.. + b (Récupération de la valeur de b)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eScope: on disait jusqu’à maintenant que le Scope gardait une liste des variables déclarées. Seulement, il peut y avoir plusieurs Scopes.\u003c/p\u003e\n\u003cp\u003eDe la même manière que les fonctions, les Scopes sont imbriqués les uns dans les autres.\u003c/p\u003e\n\u003cp\u003eSi une variable ne peut pas être trouvée dans le scope immédiat, le Moteur consulte le scope du « dessus ».\u003c/p\u003e\n\u003cp\u003eTant qu’il ne trouve pas la variable, il continue à remonter jusque tout en haut (scope dit « global »).\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eCallback queue + Event loop\u003c/h2\u003e\n\u003cp\u003eLe Javascript étant un langage single-thread ****dans un univers du Web où la réactivité est importante, les APIs WEB ****ont pensé à une solution afin d’ajouter une composante asynchrone au langage : callback queue et event loop.\u003c/p\u003e\n\u003cp\u003ele moteur de Javascript ne peut pas effectuer plusieurs actions en même temps, mais les APIs WEB ****le peuvent. On peut donc les imaginer comme des threads à part entière.\u003c/p\u003e\n\u003cp\u003eSeulement, les ****APIs WEB ne peuvent pas modifier l’ordre d’exécution du code en ajoutant des éléments dans la stack. C’est pour cela que callback queue et event loop ****ont été créées.\u003c/p\u003e\n\u003cp\u003eIl s’agit d’une sorte de « file d’attente », qui permet d’effectuer des traitements sans bloquer la pile d’exécution JS.\u003c/p\u003e\n\u003cp\u003eLe rôle de event loop est tout simple : déplacer les éléments de la callback queue dans la pile d’exécution JS ****lorsque cette dernière est vide.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/v8-eventloop.gif\" alt=\"v8-eventloop.gif\"\u003e\u003c/p\u003e\n\u003cp\u003eAttention: au même titre que la pile d’exécution JS, il n’existe qu’une seule callback queue. \u003c/p\u003e\n\u003cp\u003eÉnormément d’appels peuvent délayer tous vos autres traitements asynchrones, ce qui peut donner un effet de ralentissement.\u003c/p\u003e\n\u003cp\u003eExemple:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003econsole.log(’hi’);\n\nsetTimeout(function cb(){\n    console.log(’there’)\n}, 0);\n\nconsole.log(’JSConfEU’);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOn aura ici: hi - JSConfEU - there\u003c/p\u003e\n\u003cp\u003emême si le \u003ccode\u003esetTimeout\u003c/code\u003e se termine immédiatement, \u003cstrong\u003eevent loop\u003c/strong\u003e doit attendre que la stack soit vide avant de pouvoir y mettre les éléments de \u003cstrong\u003ecallback queue\u003c/strong\u003e. \u003ccode\u003ethere\u003c/code\u003esera donc affiché en dernier, même s’il termine avant le \u003ccode\u003econsole.log(’JSConfEU’)\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eOutil sympa: \u003ca href=\"http://latentflip.com/loupe/\"\u003ehttp://latentflip.com/loupe/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eSources\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://fr.wikipedia.org/wiki/Moteur_V8\"\u003ehttps://fr.wikipedia.org/wiki/Moteur_V8\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.axopen.com/blog/2020/08/javascript-langage-compile/\"\u003ehttps://www.axopen.com/blog/2020/08/javascript-callback-queue-event-loop/\u003c/a\u003e\u003c/p\u003e\n","title":"Moteur V8"}},"__N_SSG":true},"page":"/content/[id]","query":{"id":"frontend-javascript-moteurV8"},"buildId":"0XeLm8KfYpZBGTrmj6peW","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>